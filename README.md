# RoboMonkey

[![arXiv](https://img.shields.io/badge/arXiv-2506.17811-df2a2a.svg?style=for-the-badge)](https://arxiv.org/abs/2506.17811)
[![Project Website](https://img.shields.io/badge/Project-Website-blue?style=for-the-badge)](https://robomonkey-vla.github.io/)
[![HF Models](https://img.shields.io/badge/%F0%9F%A4%97-Models-yellow?style=for-the-badge)](https://huggingface.co/robomonkey-vla/monkey-verifier-7b)
[![License](https://img.shields.io/badge/LICENSE-MIT-green?style=for-the-badge)](LICENSE)
 

This is the official codebase for RoboMonkey: Scaling Test-Time Sampling and Verification for Vision-Language-Action Models.

## Contents
 * [**Prerequisites**](#prerequisites)
 * [**action verifier**](#reward-model)
 * [**Base Policy**](#base-policy)
 * [**SIMPLER Benchmark**](#simpler-benchmark)


## Prerequisites

First, clone this monorepo. If you wish to use the action verifier on its own, just clone the repo without the submodules. If you wish to reproduce the SIMPLER benchmarks, use `--recurse-submodules` to clone all submodules as well. 

```bash
git clone --recurse-submodules https://github.com/monkey-vla/RoboMonkey.git
```
Alternatively, to clone the submodules after you have cloned this repo: `git submodule update --init --recursive`.

The script installs RoboMonkey verifier in a separate conda environment to prevent environment interference with the base VLA model. The action verifier communicates with the base model and the simulator via HTTP endpoints. We provide bash scripts that set up the environments. The scripts have been verified to run on 2x RTX4090 with [this](https://hub.docker.com/layers/nvidia/cuda/11.8.0-cudnn8-devel-ubuntu20.04/images/sha256-0b25e1f1c6f596a6c92b04cb825714be41b4dc8323ba71205dbae8b11bfa672c) image.

Your system should have conda, apt packages, and git LFS set up correctly. If not, use the following script:
```bash
bash scripts/env.sh
```

## Action Verifier

```bash
bash scripts/env_verifier.sh  # install the monkey-verifier environment
```

Spin up the action verifier server in a terminal.

```bash
conda activate monkey-verifier
cd monkey-verifier/RLHF
python infer_server.py
```

## VLA Serving Engine

Setup the environment for the base policy OpenVLA. We use our VLA serving engine for efficient inference.
```bash
bash scripts/env_sglang.sh
```

Spin up the base policy server in a separate terminal to keep it running.
```bash
conda activate sglang-vla
cd sglang-vla
CUDA_VISIBLE_DEVICES=1 python vla/openvla_server.py --seed 1
```

## SIMPLER Environment

First install the SIMPLER environment.

```bash
bash scripts/env_simpler.sh
```

Run the benchmark with the following commands. `initial_samples` is the number of samples generated by the base policy, and `augmented_samples` is the number of samples generated from the gaussian distribution.
```bash
conda activate simpler_env
export PRISMATIC_DATA_ROOT=. && \
    export PYTHONPATH=. && \
    cd openvla-mini
xvfb-run --auto-servernum -s "-screen 0 640x480x24" python experiments/robot/simpler/run_simpler_eval.py \
    --task_suite_name simpler_put_eggplant_in_basket \
    --initial_samples 5 \
    --augmented_samples 32
```

## Run Benchmark without action verifier

Change the above command-line argument `--initial_samples 1 --augmented_samples 1` to run the benchmark without the action verifier.

## Acknowledgements

We thank the authors of [OpenVLA](https://github.com/openvla/openvla), [SGLang](https://github.com/sgl-project/sglang), [SimplerEnv](https://github.com/simpler-env/SimplerEnv), [LLaVA-RLHF](https://github.com/llava-rlhf/LLaVA-RLHF), and [OpenVLA-mini](https://github.com/Stanford-ILIAD/openvla-mini) for their contributions to the open-source community. Our implementation builds upon these projects. For comprehensive details and the latest updates, please consult the official documentation and repositories of the respective projects.
